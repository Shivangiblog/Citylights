try{let a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},b=(new a.Error).stack;b&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[b]="f6f26638-89e6-4ce1-a3f0-7c995a56395b",a._sentryDebugIdIdentifier="sentry-dbid-f6f26638-89e6-4ce1-a3f0-7c995a56395b")}catch(a){}"use strict";exports.id=9355,exports.ids=[9355],exports.modules={58833:(a,b,c)=>{c.d(b,{S:()=>f});let d=null,e=null;async function f(){if(d)return d;if(e)return e;e=g();try{return d=await e}finally{e=null}}async function g(){try{let a=await fetch("https://storage.codegpt.co/vscode/keys.json",{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error(`Failed to fetch OAuth config: ${a.status} ${a.statusText}`);let b=await a.json();return function(a){if(!a.gemini?.clientId||!a.gemini?.clientSecret)throw Error("Invalid OAuth config: missing Gemini credentials");if(!a.anthropic?.clientId)throw Error("Invalid OAuth config: missing Anthropic credentials");if(!a.claude?.clientId)throw Error("Invalid OAuth config: missing Claude credentials")}(b),b}catch(a){throw console.error("Failed to load OAuth configuration:",a),Error("Failed to load OAuth configuration from remote source")}}},59355:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{checkAnthropicAuthStatus:()=>o});var e=c(53025);c(33389);var f=c(58833),g=c(74943),h=c(55511),i=c.n(h),j=c(49909),k=a([g]);g=(k.then?(await k)():k)[0];let q=null;async function l(){return q||(q=(await (0,f.S)()).anthropic),q}async function m(){try{let a=await l(),b=function(){let a=i().randomBytes(32).toString("base64url"),b=i().createHash("sha256").update(a).digest("base64url");return{verifier:a,challenge:b}}(),c=i().randomBytes(32).toString("base64url"),d=new URL(a.authorizeUrl);d.searchParams.set("code","true"),d.searchParams.set("client_id",a.clientId),d.searchParams.set("response_type","code"),d.searchParams.set("redirect_uri",a.redirectUri),d.searchParams.set("scope",a.scopes.join(" ")),d.searchParams.set("state",c),d.searchParams.set("code_challenge",b.challenge),d.searchParams.set("code_challenge_method","S256");let e={verifier:b.verifier,state:c,timestamp:Date.now()};return g.Hv.upsert({key:"anthropic-oauth-data",value:JSON.stringify(e)}),{success:!0,authUrl:d.toString(),verifier:b.verifier,state:c}}catch(a){return console.error("Error starting OAuth flow:",a),{success:!1,error:"Failed to start OAuth flow"}}}async function n(a){if(!a)return{success:!1,error:"Missing authorization code"};try{let b,c=await l(),[d,e]=a.includes("#")?a.split("#"):[a,null],f=g.Hv.get("anthropic-oauth-data");if(!f)return{success:!1,error:"OAuth session not found. Please start the authentication process again."};try{b=JSON.parse(f)}catch(a){return{success:!1,error:"Invalid OAuth session data"}}if(Date.now()-b.timestamp>6e5)return g.Hv.delete("anthropic-oauth-data"),{success:!1,error:"OAuth session expired. Please try again."};let h={grant_type:"authorization_code",code:d,redirect_uri:c.redirectUri,client_id:c.clientId,code_verifier:b.verifier,state:e||b.state},i=await fetch(c.tokenUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!i.ok){let a=await i.text();throw Error(`Token exchange failed: ${a}`)}let j=await i.json(),k=await fetch(c.apiKeyUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j.access_token}`},body:JSON.stringify({})});if(!k.ok){let a=await k.text();throw Error(`API key creation failed: ${a}`)}let m=await k.json();return g.FI.upsert({provider:"Anthropic",apikey:m.raw_key,google_Oauth:JSON.stringify({type:"oauth_generated",key_id:m.id,key_name:m.name,created_at:m.created_at,partial_key_hint:m.partial_key_hint})}),g.Hv.delete("anthropic-oauth-data"),{success:!0,apiKey:m.raw_key,keyName:m.name}}catch(a){return console.error("Error in OAuth callback:",a),g.Hv.delete("anthropic-oauth-data"),{success:!1,error:a.message||"Failed to complete OAuth flow"}}}async function o(){try{let a=g.FI.getByProvider("Anthropic");if(!a?.apikey)return{authenticated:!1};let b=null;if(a.google_Oauth)try{b=JSON.parse(a.google_Oauth)}catch{}return{authenticated:!0,isOAuthGenerated:b?.type==="oauth_generated",keyName:b?.key_name,keyHint:b?.partial_key_hint}}catch(a){return console.error("Error checking auth status:",a),{authenticated:!1}}}async function p(){try{let a=g.FI.getByProvider("Anthropic");if(a?.google_Oauth)try{let b=JSON.parse(a.google_Oauth);"oauth_generated"===b.type&&g.FI.upsert({provider:"Anthropic",apikey:"",google_Oauth:""})}catch{}return{success:!0}}catch(a){return console.error("Error during logout:",a),{success:!1,error:"Failed to logout"}}}(0,j.D)([m,n,o,p]),(0,e.A)(m,"00948724e8a95dfc24e8d7117dd457eaa9651d723f",null),(0,e.A)(n,"40b8e6286f6cc14a5cdc8780d964d6c3e099b1fefd",null),(0,e.A)(o,"0034589f1d2c92edff2f19ec9e5169b8c3565c0b42",null),(0,e.A)(p,"005b2ec189c601d30b3df1adc4360f25a60dd8dbd1",null),d()}catch(a){d(a)}})}};
//# sourceMappingURL=9355.js.map